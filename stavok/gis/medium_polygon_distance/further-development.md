# Подальший розвиток методу

30.9.2022, ole

## Формулювання задачі

На поверхні геоїда (Землі) задані декілька суміжних територій (замкнених полігонів), тобто що не перетинаються між собою, але мають спільні межі у вигляді незамкнених полігонів. Тут **не розглядається** варіант анклавів (тобто вкладених замкнених полігонів).

**Задача**: з'ясувати, 

1. До якої з територій $i$ належить точка $P$ з визначеними координатами $Lat, Lon$?
2. Яка відстань $L$ від цієї точки $P$, розташованої всередині певної території $i$, до межі із заданою суміжною територією $j$?

## Що для цього треба

Потрібно розробити низку ключових методів, зокрема:

1) Метод `p2poly(points, polygons)`: винайти (найменшу) відстань $L$ від точки $P$ до замкненого полігону $A$, а також відповідну точку $X$, що належить цьому полігону, на відстані $L$ від точки $P$. 
2) Метод `is_in_poly(points, polygons)`: чи розташована точка $P$ всередині замкненого полігону $A$.
3) Метод `cut_area(polygon, cutting_line, control_points)`: розрізати територію (замкнений полігон) лінією (відкритим полігоном), утворивши дві нових території.
4) Метод `ukr_bel_rf`: словник полігонів меж суходолу України, рф, рб і акваторії Чорного та Азовського морів. 

## Додаткові міркування

* Початок рішення тут [airscape/article\_UKR.md at master · protw/airscape · GitHub](https://github.com/protw/airscape/blob/master/stavok/gis/medium_polygon_distance/article_UKR.md), а також у статті на цю тему [Найменша відстань до полігону на поверхні геоїду | by Olegh Bondarenko | Stinopys | Medium](https://medium.com/p/bdc1550d19da) 
* Конкретно стосовно лінії фронту московсько-української війни, то потрібні наступні замкнені полігони - 
  * Україна поділена на дві частини: (1) вільна та (2) окупована, 
  * (3) РФ і (4) білорусь,
  * а також (5) Чорне та Азовське моря включно з усіма лиманами.
* Через мінливість лінії фронту додатковою задачею виникне поділ замкненого полігону (контуру України) незамкненим полігоном (лінією фронту) на два суміжних замкнених полігони. Ба більше, таких ліній фронту було декілька окремих на початку вторгнення.

## Алгоритм

Алгоритм на верхньому рівні матиме такий вигляд:

```python
def boundaries(datetime, control_points):
  areas = ukr_bel_rf() # гео межі України, рб, рф, акваторії Чорного і Азовського морів
  frontline = rf_ukr_frontline(datetime) # лінія фронту на заданий день і час
  # сегментація контуру меж України по лінії фронту на два або білше полігони -
  # вільна і окупована частини
  two_areas = cut_area(areas['ukr'], frontline, control_points)
  # замінити елемент 'ukr' на два нових 'ukr_free' і 'ukr_occupied'
  areas.pop('ukr') # видалити одну територію
  areas.update(two_areas) # додати дві нових території
  return area

# дві контрольних точки, перша точно належить 'ukr_free', друга - точно 'ukr_occupied'
control_points = {'ukr_free':pnt1, 'ukr_occupied':pnt2}

'''
Параметри 'pnts' і 'selected_datetime' визначені вище цього фрагменту
'''

# гео межі вільної та окупованої України, рб, рф, акваторії Чорного і 
# Азовського морів на обрану дату 'selected_datetime'
areas = boundaries(datetime=selected_datetime, control_points=control_points)

# список належності точок до конкретної території
whos_area = points_in_polygons(points=pnts, polygons=areas)

# відстань до лінії фронту від точок 'pnts'
dist2frontline = p2poly(points=pnts, frontline)
```
